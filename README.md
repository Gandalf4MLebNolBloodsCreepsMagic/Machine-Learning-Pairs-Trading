Machine Learning-Assisted Pairs Trading Strategy (Stacking Ensemble)
Project Description
This project implements an advanced statistical arbitrage (Pairs Trading) strategy on S&P 500 components. The core innovation lies in the use of a Stacking Ensemble Learning architecture to filter signals generated by an Ornstein-Uhlenbeck process. This approach transforms a traditional mean-reversion strategy into a robust, systematic trading system.

Authors: LEBEAU, PATHMASRI, NASSOUR

Methodology & Pipeline
1. Rigorous Selection (Anti-Bias)
Out-of-Sample Selection: Cointegrated pairs (Engle-Granger) are identified based exclusively on data prior to 2023-01-01 to prevent survivorship or look-ahead bias.

Stationarity: Validation using the Augmented Dickey-Fuller (ADF) test on historical spreads.

2. Advanced Feature Engineering (Market-Aware)
To achieve a competitive AUC score, we enriched the model with market regime indicators:

Z-Score/Volatility Interaction: Contextualizes the spread gap relative to market nervousness.

Z-Score Velocity: Calculates the slope of the spread to identify the beginning of convergence.

Macro Indicator (S&P 500 RSI): Integrates "global market weather" via the ^GSPC index to filter out systemic panic periods.

3. Machine Learning Architecture (Stacking Trio)
We moved beyond simple voting to a Stacking (Meta-Learning) architecture to maximize AUC:

Level 1 (Base Learners):

Logistic Regression: Stable linear baseline.

Random Forest: Captures non-linear interactions.

XGBoost: Optimized Gradient Boosting (max_depth=3, learning_rate=0.03) to sequentially correct errors from other models.

Level 2 (Meta-Learner): A final Logistic Regression that learns how to weigh the base models' predictions according to specific market conditions.

4. Labeling with Neutral Zone
To reduce market noise, we implemented a neutral zone: the model only learns from movements where the profit exceeds a significant volatility threshold, improving signal clarity.

Results and Performance
AUC Improvement: The combined approach (Advanced Features + Stacking) achieves a stable AUC score of 0.55 - 0.58, which is highly significant in quantitative finance.

Smart Sizing: Position sizing is proportional to the success probability predicted by the Meta-Learner, optimizing the Sharpe Ratio.

Risk Filter: The ML model successfully identifies "drifting spreads," avoiding significant losses where a traditional OU strategy would have failed.

Notebook Structure
Configuration & Imports: xgboost installation and environment setup.

Strict Screening: Identifying cointegrated pairs before the 2023 cutoff.

Advanced Dataset: Building interaction features and market RSI.

Stacking Classifier: Cross-validation (5-fold CV) training of the meta-model.

ROC Analysis: Visual performance comparison of all models.

Final Backtest: PnL simulation with dynamic risk management.
